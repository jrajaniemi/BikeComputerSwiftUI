import json
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta

def create_gpx(route):
    gpx = ET.Element('gpx', version="1.1", creator="YourApp")
    trk = ET.SubElement(gpx, 'trk')
    name = ET.SubElement(trk, 'name')
    name.text = route['name']
    trkseg = ET.SubElement(trk, 'trkseg')

    for point in route['points']:
        trkpt = ET.SubElement(trkseg, 'trkpt', lat=str(point['latitude']), lon=str(point['longitude']))
        ele = ET.SubElement(trkpt, 'ele')
        ele.text = str(point['altitude'])
        time = ET.SubElement(trkpt, 'time')
        # Convert timestamp to ISO 8601 format
        timestamp = datetime(2001, 1, 1) + timedelta(seconds=point['timestamp'])
        time.text = timestamp.strftime('%Y-%m-%dT%H:%M:%SZ')

    return ET.tostring(gpx, encoding='unicode')

def main():
    with open('route.json', 'r') as f:
        route = json.load(f)

    gpx_data = create_gpx(route)

    with open('route.gpx', 'w') as f:
        f.write(gpx_data)

if __name__ == "__main__":
    main()
